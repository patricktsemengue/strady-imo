<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Strady . imo - Advanced Prototype v14</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@600&family=The+Girl+Next+Door&family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/jpeg" href="S-fav-icon.jpg" />
    
    <style>
        :root {
            --dark-green: #004d40; 
            --light-blue: #73c8f0f9; 
            --orange: #f76c1c;     
            --background: #f4f6f8;
            --card-bg: #ffffff;
            --text-primary: #212122;
            --text-secondary: #757575;
            --border-color: #e0e0e0;
            --delete-red: #ef5350;
            --header-height: 73px;
            --sidebar-width-open: 220px;
            --sidebar-width-closed: 72px;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Poppins', sans-serif; background-color: var(--background); color: var(--text-primary); }

        .app-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; background-color: var(--card-bg); border-bottom: 1px solid var(--border-color); position: sticky; top: 0; width: 100%; z-index: 1002; height: var(--header-height); }
        .header-left { display: flex; align-items: center; gap: 1rem; }
        .page-wrapper { display: flex; }
        .main-content-wrapper { flex-grow: 1; display: flex; flex-direction: column; min-height: calc(100vh - var(--header-height)); transition: margin-left 0.3s ease-in-out; }
        .main-content { padding: 2rem; flex-grow: 1; }
        
        .sidebar { position: sticky; top: var(--header-height); height: calc(100vh - var(--header-height)); background-color: var(--card-bg); border-right: 1px solid var(--border-color); width: var(--sidebar-width-open); padding: 1rem; display: flex; flex-direction: column; transition: width 0.3s ease-in-out, transform 0.3s ease-in-out; flex-shrink: 0; z-index: 999; }
        .sidebar-nav { flex-grow: 1; }
        .sidebar ul { list-style: none; }
        .sidebar li { display: flex; align-items: center; padding: 0.8rem 1rem; border-radius: 8px; cursor: pointer; font-weight: 600; margin-bottom: 0.5rem; white-space: nowrap; overflow: hidden; }
        .sidebar li .nav-icon { margin-right: 12px; font-size: 1.2rem; width: 20px; text-align: center; }
        .sidebar li .nav-text { transition: opacity 0.2s; }
        .sidebar li.active { background-color: var(--dark-green); color: white; }
        .sidebar li a { text-decoration: none; color: var(--orange); display: flex; align-items: center; width: 100%; }
        .sidebar-toggle { background-color: var(--background); border: 1px solid var(--border-color); border-radius: 50%; width: 32px; height: 32px; cursor: pointer; display: flex; align-items: center; justify-content: center; align-self: center; margin-top: 1rem; transition: transform 0.3s ease-in-out; }
        
        body.sidebar-collapsed .sidebar { width: var(--sidebar-width-closed); }
        body.sidebar-collapsed .sidebar li { justify-content: center; }
        body.sidebar-collapsed .sidebar .nav-icon { margin-right: 0; }
        body.sidebar-collapsed .sidebar .nav-text { opacity: 0; width: 0; }
        body.sidebar-collapsed .sidebar-toggle { transform: rotate(180deg); }
        body:not(.mobile-view) .main-content-wrapper { margin-left: var(--sidebar-width-open); }
        body:not(.mobile-view).sidebar-collapsed .main-content-wrapper { margin-left: var(--sidebar-width-closed); }

        .logo { display: flex; align-items: baseline; gap: 4px; }
        .logo-s { font-family: 'Caveat', cursive; font-size: 2.4rem; font-weight: 600; font-style: italic; color: var(--dark-green); transform: translateX(2px); }
        .logo-trady { font-family: 'The Girl Next Door', cursive; font-size: 1.8rem; color: var(--dark-green); font-style: oblique; font-weight: 600; padding-bottom: 5px; }
        .logo-dot { font-size: 2.2rem; font-weight: 700; color: var(--orange); }
        .logo-imo { font-family: 'Poppins', sans-serif; font-size: 1.1rem; font-weight: 500; color: var(--light-blue); padding: 0.1rem 0.5rem; border-radius: 6px; border-top: 2.5px solid var(--light-blue); border-right: 2.5px solid var(--light-blue); border-bottom: 2.5px solid var(--light-blue); line-height: 1.2; }
        
        .cta-button { background-color: var(--orange); color: white; border: none; padding: 0.8rem 1.5rem; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer; }
        
        .strategy-dashboard h2 { margin-bottom: 1.5rem; color: var(--dark-green); }
        .strategy-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1.5rem; }
        .strategy-card { background-color: var(--card-bg); border-radius: 12px; padding: 1.5rem; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: 1px solid var(--border-color); display: flex; flex-direction: column; }
        .strategy-card-content { flex-grow: 1; }
        .strategy-card h3 { color: var(--dark-green); margin-bottom: 1rem; }
        .strategy-card p { color: var(--text-secondary); line-height: 1.6; }
        .strategy-card.empty { border: 2px dashed var(--border-color); align-items: center; justify-content: center; color: var(--text-secondary); background-color: transparent; box-shadow: none; }
        .card-actions { margin-top: 1.5rem; display: flex; justify-content: flex-end; gap: 0.5rem; }
        .card-button { background-color: var(--background); border: none; border-radius: 50%; width: 36px; height: 36px; cursor: pointer; font-size: 1rem; display: flex; align-items: center; justify-content: center; transition: all 0.2s ease-out; }
        .card-button.edit { color: #0288d1; background-color: #e1f5fe; }
        .card-button.edit:hover { background-color: var(--light-blue); color: white; transform: scale(1.1); }
        .card-button.delete { color: #d32f2f; background-color: #ffebee; }
        .card-button.delete:hover { background-color: var(--delete-red); color: white; transform: scale(1.1); }
        
        /* --- Foldable Form Editor --- */
        .strategy-editor { position: fixed; top: 20px; right: 20px; bottom: 20px; width: 100%; max-width: 450px; background-color: var(--card-bg); border-radius: 16px; box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 1001; display: flex; flex-direction: column; opacity: 0; transform: translateX(105%); visibility: hidden; transition: transform 0.5s cubic-bezier(0.25, 1, 0.5, 1), opacity 0.5s, visibility 0.5s; }
        .strategy-editor.open { opacity: 1; transform: translateX(0); visibility: visible; }
        .editor-header { display: flex; justify-content: space-between; align-items: center; padding: 1rem 1.5rem; border-bottom: 1px solid var(--border-color); flex-shrink: 0; }
        .close-button { background-color: var(--background); border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-secondary); border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; }
        .editor-content { padding: 0 0.5rem 1.5rem 0.5rem; overflow-y: auto; flex-grow: 1; }
        #strategyForm { padding: 1rem 1rem 0 1rem; }
        .form-phase { border: 1px solid var(--border-color); border-radius: 8px; margin-bottom: 1rem; overflow: hidden; background-color: var(--card-bg); }
        .phase-header { width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 1rem; background-color: transparent; border: none; cursor: pointer; font-size: 1rem; font-weight: 600; color: var(--dark-green); }
        .phase-toggle-icon { transition: transform 0.3s; }
        .phase-header.open .phase-toggle-icon { transform: rotate(180deg); }
        .phase-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-in-out; }
        .phase-content.open { max-height: 500px; }
        .phase-content-inner { padding: 1.5rem; border-top: 1px solid var(--border-color); background-color: var(--background); }
        .form-field { margin-bottom: 1rem; }
        .form-field:last-child { margin-bottom: 0; }
        .form-field label { display: block; margin-bottom: 0.5rem; font-weight: 500; font-size: 0.9rem; color: var(--text-secondary); }
        .form-field input { width: 100%; padding: 0.8rem 1rem; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; }
        .form-field input[readonly] { background-color: #eceff1; color: var(--text-secondary); cursor: not-allowed; }
        .form-field input:focus { outline: none; border-color: var(--light-blue); box-shadow: 0 0 0 3px rgba(115, 200, 240, 0.3); }

        .overlay { position: fixed; left: 0; top: var(--header-height); width: 100%; height: calc(100vh - var(--header-height)); z-index: 1000; opacity: 0; visibility: hidden; transition: opacity 0.5s; backdrop-filter: blur(0); }
        .overlay.visible { opacity: 1; visibility: visible; backdrop-filter: blur(4px); }
        .fab { display: none; position: fixed; bottom: 20px; right: 20px; width: 56px; height: 56px; border-radius: 50%; background-color: var(--orange); color: white; border: none; box-shadow: 0 4px 12px rgba(0,0,0,0.2); font-size: 28px; line-height: 56px; text-align: center; cursor: pointer; z-index: 999; }
        
        .mobile-menu-toggle { display: none; background: none; border: none; font-size: 1.8rem; cursor: pointer; }
        @media (max-width: 768px) {
            .cta-button { display: none; }
            .fab { display: block; }
            .mobile-menu-toggle { display: block; }
            .main-content-wrapper { margin-left: 0 !important; }
            .sidebar { top: 0; height: 100vh; transform: translateX(-100%); z-index: 1003; }
            body.sidebar-open-mobile .sidebar { transform: translateX(0); }
            .strategy-editor { top: 0; right: 0; bottom: 0; max-width: 100%; border-radius: 0; transform: translateX(110%); }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-left">
                <button id="mobileMenuToggle" class="mobile-menu-toggle">☰</button>
                <div class="logo">
                     <span class="logo-s">S</span><span class="logo-trady">trady</span><span class="logo-dot"> . </span><span class="logo-imo">imo</span>
                </div>
            </div>
            <button id="createNewStrategyBtn" class="cta-button">Create New Strategy</button>
        </header>

        <div class="page-wrapper">
            <nav class="sidebar" id="sidebar">
                <ul class="sidebar-nav">
                    <li class="active"><span class="nav-icon">🗂️</span><span class="nav-text"> My Strategies</span></li>
                    <li><a href="#"><span class="nav-icon">★</span><span class="nav-text">Upgrade to Premium</span></a></li>
                </ul>
                <button id="sidebarToggle" class="sidebar-toggle">⟨</button>
            </nav>
            <div class="main-content-wrapper">
                <main class="main-content">
                    <section class="strategy-dashboard">
                        <h2>My Investment Strategies</h2>
                        <div id="strategyGrid" class="strategy-grid">
                            </div>
                    </section>
                </main>
            </div>
        </div>
    </div>

    <button id="createNewStrategyFab" class="fab">+</button>
    <aside id="strategyEditor" class="strategy-editor">
        <div class="editor-header">
            <h3 id="editorTitle">New Strategy</h3>
            <button id="closeEditorBtn" class="close-button">&times;</button>
        </div>
        <div class="editor-content">
             <form id="strategyForm">
                <div class="form-field" style="margin-bottom: 1.5rem;"><label for="strategyName">Strategy Name</label><input type="text" id="strategyName" placeholder="e.g., Brussels Centre Apartment" required></div>
                <div class="accordion-container">
                    <div class="form-phase"><button type="button" class="phase-header"><span class="phase-title">Acquisition</span><span class="phase-toggle-icon">▼</span></button><div class="phase-content"><div class="phase-content-inner"><div class="form-field"><label for="acqPrice">Price (€)</label><input type="number" id="acqPrice" placeholder="250000"></div><div class="form-field"><label for="acqSuperficie">Surface (m²)</label><input type="number" id="acqSuperficie" placeholder="80"></div></div></div></div>
                    <div class="form-phase"><button type="button" class="phase-header"><span class="phase-title">Renovation</span><span class="phase-toggle-icon">▼</span></button><div class="phase-content"><div class="phase-content-inner"><div class="form-field"><label for="renoCost">Cost (€)</label><input type="number" id="renoCost" placeholder="15000"></div></div></div></div>
                    <div class="form-phase"><button type="button" class="phase-header"><span class="phase-title">Financing</span><span class="phase-toggle-icon">▼</span></button><div class="phase-content"><div class="phase-content-inner"><div class="form-field"><label for="finPersonal">Personal Contribution (€)</label><input type="number" id="finPersonal" placeholder="50000"></div><div class="form-field"><label for="finLoan">Loan (€)</label><input type="number" id="finLoan" readonly></div><div class="form-field"><label for="finDuration">Duration (years)</label><input type="number" id="finDuration" placeholder="25"></div><div class="form-field"><label for="finRefund">Monthly Refund (€)</label><input type="number" id="finRefund" placeholder="850"></div></div></div></div>
                    <div class="form-phase"><button type="button" class="phase-header"><span class="phase-title">Rental</span><span class="phase-toggle-icon">▼</span></button><div class="phase-content"><div class="phase-content-inner"><div class="form-field"><label for="rentPrice">Price (€/month)</label><input type="number" id="rentPrice" placeholder="1100"></div><div class="form-field"><label for="rentExpenses">Expenses (€/month)</label><input type="number" id="rentExpenses" placeholder="150"></div></div></div></div>
                    <div class="form-phase"><button type="button" class="phase-header"><span class="phase-title">Summary</span><span class="phase-toggle-icon">▼</span></button><div class="phase-content"><div class="phase-content-inner"><p>Gross Yield: <strong id="summaryYield">--%</strong></p><p>Monthly Cashflow: <strong id="summaryCashflow">€--</strong></p></div></div></div>
                </div>
                <button type="submit" class="cta-button" style="width:100%; margin-top: 1.5rem;">Save Strategy</button>
            </form>
        </div>
    </aside>
    <div id="overlay" class="overlay"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const body = document.body;
            const createNewStrategyBtn = document.getElementById('createNewStrategyBtn');
            const createNewStrategyFab = document.getElementById('createNewStrategyFab');
            const strategyEditor = document.getElementById('strategyEditor');
            const closeEditorBtn = document.getElementById('closeEditorBtn');
            const overlay = document.getElementById('overlay');
            const sidebarToggle = document.getElementById('sidebarToggle');
            const mobileMenuToggle = document.getElementById('mobileMenuToggle');
            const strategyGrid = document.getElementById('strategyGrid');
            let nextId = 5;
            
            const sampleStrategies = [
                { id: 1, name: "Brussels Centre Apartment", region: "Brussels", cashflow: 450 },
                { id: 2, name: "Ghent Student Housing", region: "Flanders", cashflow: 275 },
                { id: 3, name: "Antwerp Fixer-Upper", region: "Flanders", cashflow: -50 },
                { id: 4, name: "Charleroi Rental Unit", region: "Wallonia", cashflow: 320 }
            ];

            function renderStrategies() {
                strategyGrid.innerHTML = sampleStrategies.map(strategy => `
                    <div class="strategy-card" data-id="${strategy.id}">
                        <div class="strategy-card-content">
                            <h3>${strategy.name}</h3>
                            <p><strong>Region:</strong> ${strategy.region}</p>
                            <p><strong>Cashflow:</strong> €${strategy.cashflow}/month</p>
                        </div>
                        <div class="card-actions">
                            <button class="card-button edit" aria-label="Edit Strategy">✏️</button>
                            <button class="card-button delete" aria-label="Delete Strategy">🗑️</button>
                        </div>
                    </div>
                `).join('') + '<div class="strategy-card empty">Empty Strategy Slot</div>';
            }
            renderStrategies();
            
            const isMobile = () => window.innerWidth <= 768;
            if (isMobile()) body.classList.add('mobile-view');
            window.addEventListener('resize', () => { body.classList.toggle('mobile-view', isMobile()); if (!isMobile()) body.classList.remove('sidebar-open-mobile'); });
            if (localStorage.getItem('sidebarState') === 'collapsed' && !isMobile()) { body.classList.add('sidebar-collapsed'); }
            sidebarToggle.addEventListener('click', () => { if (isMobile()) return; body.classList.toggle('sidebar-collapsed'); localStorage.setItem('sidebarState', body.classList.contains('sidebar-collapsed') ? 'collapsed' : 'expanded'); });
            mobileMenuToggle.addEventListener('click', (e) => { e.stopPropagation(); body.classList.toggle('sidebar-open-mobile'); overlay.classList.add('visible'); });

            const openEditorFunc = () => { strategyEditor.classList.add('open'); overlay.classList.add('visible'); body.classList.remove('sidebar-open-mobile'); };
            const closeEditorFunc = () => { strategyEditor.classList.remove('open'); if (!body.classList.contains('sidebar-open-mobile')) { overlay.classList.remove('visible'); } };
            createNewStrategyBtn.addEventListener('click', openEditorFunc);
            createNewStrategyFab.addEventListener('click', openEditorFunc);
            closeEditorBtn.addEventListener('click', closeEditorFunc);
            overlay.addEventListener('click', () => {
                if (body.classList.contains('sidebar-open-mobile')) { body.classList.remove('sidebar-open-mobile'); overlay.classList.remove('visible'); }
                if (strategyEditor.classList.contains('open')) { closeEditorFunc(); }
            });

            // Accordion and Calculation Logic
            const formInputs = {
                acqPrice: editor.querySelector('#acqPrice'),
                finPersonal: editor.querySelector('#finPersonal'),
                finLoan: editor.querySelector('#finLoan'),
                rentPrice: editor.querySelector('#rentPrice'),
                rentExpenses: editor.querySelector('#rentExpenses'),
                finRefund: editor.querySelector('#finRefund'),
                summaryCashflow: editor.querySelector('#summaryCashflow')
            };

            editor.addEventListener('click', function(e) {
                const header = e.target.closest('.phase-header');
                if (header) {
                    const content = header.nextElementSibling;
                    header.classList.toggle('open');
                    content.classList.toggle('open');
                }
            });

            function updateCalculations() {
                const price = parseFloat(formInputs.acqPrice.value) || 0;
                const contribution = parseFloat(formInputs.finPersonal.value) || 0;
                const rent = parseFloat(formInputs.rentPrice.value) || 0;
                const expenses = parseFloat(formInputs.rentExpenses.value) || 0;
                const refund = parseFloat(formInputs.finRefund.value) || 0;
                
                const loanAmount = price - contribution;
                formInputs.finLoan.value = loanAmount > 0 ? loanAmount.toFixed(0) : '';

                const cashflow = rent - expenses - refund;
                formInputs.summaryCashflow.textContent = `€${cashflow.toFixed(2)}`;
            }
            editor.addEventListener('input', updateCalculations);
        });
    </script>
</body>
</html>